<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <!-- <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-eval';"> -->
    <meta
      http-equiv="Content-Security-Policy"
      content="script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net https://script.google.com https://script.googleusercontent.com; worker-src 'self' blob: data:; connect-src 'self' https://script.google.com https://script.googleusercontent.com; object-src 'none';"
    />
    <title>QUẢN LÝ VẬN ĐƠN LumiGlobal</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pako/dist/pako.min.js"></script>
    <link rel="stylesheet" href="style.css" />
  </head>

  <body>
    <div id="loader-overlay">
      <img
        src="https://www.appsheet.com/template/gettablefileurl?appName=Appsheet-325045268&tableName=Kho%20%E1%BA%A3nh&fileName=Kho%20%E1%BA%A3nh_Images%2Ff930e667.%E1%BA%A2nh.025539.jpg"
        alt="Loading Logo"
      />
    </div>

    <div class="page-header">
      <img
        class="header-logo"
        src="https://www.appsheet.com/template/gettablefileurl?appName=Appsheet-325045268&tableName=Kho%20%E1%BA%A3nh&fileName=Kho%20%E1%BA%A3nh_Images%2Ff930e667.%E1%BA%A2nh.025539.jpg"
        alt="LumiGlobal Logo"
      />
      <h2>QUẢN LÝ VẬN ĐƠN LumiGlobal</h2>
    </div>

    <div class="tab-controls">
      <button id="tabData" class="tab-btn active">Dữ liệu đơn hàng</button>
      <button id="tabAllRegions" class="tab-btn" style="display: none">
        Tổng đơn 2 miền
      </button>
      <button id="tabJapan" class="tab-btn">Đơn Nhật</button>
      <button id="tabReport" class="tab-btn">Báo cáo tổng kết</button>
    </div>

    <div id="contentData" class="content-tab active">
      <div class="controls">
        <div class="left-controls">
          <span id="userInfo"></span>
          <button id="refreshData" class="refresh-btn">
            <span class="refresh-icon">↻</span> Load
          </button>
          <button id="updateAll" class="update-btn">Cập nhật</button>
          <div class="fixed-col-control">
            <span>Cột cố định:</span>
            <input
              type="number"
              id="fixedColumnCountInput"
              value="1"
              min="0"
              style="width: 70px"
            />
          </div>
          <div id="summaryInfo" class="summary-info"></div>
          <div
            id="selectionSummary"
            class="summary-info"
            style="background-color: #e8f5e9; border: 1px solid #a5d6a7"
          ></div>
        </div>
        <div class="right-controls">
          <div id="staffDropdown"></div>
          <div class="date-filter">
            <span>Từ:</span><input type="date" id="startDateFilter" />
            <span>Đến:</span><input type="date" id="endDateFilter" />
          </div>
          <select id="productFilter" class="filter-select">
            <option value="">Tất cả sản phẩm</option>
          </select>
          <select id="marketFilter" class="filter-select">
            <option value="">Tất cả khu vực</option>
          </select>
          <button id="clearFilters" class="clear-filter-btn">Xóa lọc</button>
        </div>
      </div>
      <div class="main-table-wrapper" id="tableContainer">
        <table>
          <thead id="tableHead"></thead>
          <tbody id="tableBody"></tbody>
        </table>
      </div>
    </div>

    <div id="contentAllRegions" class="content-tab">
      <div class="controls">
        <div class="left-controls">
          <span class="tab-info-text">Toàn bộ đơn hàng</span>
          <button id="allRegionsRefreshData" class="refresh-btn">
            <span class="refresh-icon">↻</span> Load
          </button>
          <button id="allRegionsUpdateAll" class="update-btn">Cập nhật</button>
          <div id="allRegionsSummaryInfo" class="summary-info"></div>
        </div>
        <div class="right-controls">
          <div class="date-filter">
            <span>Từ:</span
            ><input type="date" id="allRegionsStartDateFilter" />
            <span>Đến:</span><input type="date" id="allRegionsEndDateFilter" />
          </div>
          <select id="allRegionsProductFilter" class="filter-select">
            <option value="">Sản phẩm</option>
          </select>
          <select id="allRegionsMarketFilter" class="filter-select">
            <option value="">Khu vực</option>
          </select>
          <select id="allRegionsStaffFilter" class="filter-select">
            <option value="">NV Vận đơn</option>
          </select>
          <button id="allRegionsClearFilters" class="clear-filter-btn">
            Xóa lọc
          </button>
        </div>
      </div>
      <div class="main-table-wrapper" id="allRegionsTableContainer">
        <table>
          <thead id="allRegionsTableHead"></thead>
          <tbody id="allRegionsTableBody"></tbody>
        </table>
      </div>
    </div>

    <div id="contentJapan" class="content-tab">
      <div class="controls">
        <div class="left-controls">
          <span class="tab-info-text">Đơn hàng khu vực: Nhật Bản</span>
          <button id="japanRefreshData" class="refresh-btn">
            <span class="refresh-icon">↻</span> Load
          </button>
          <button id="japanUpdateAll" class="update-btn">Cập nhật</button>
          <div id="japanSummaryInfo" class="summary-info"></div>
        </div>
        <div class="right-controls">
          <div class="date-filter">
            <span>Từ:</span><input type="date" id="japanStartDateFilter" />
            <span>Đến:</span><input type="date" id="japanEndDateFilter" />
          </div>
          <select id="japanProductFilter" class="filter-select">
            <option value="">Sản phẩm</option>
          </select>
          <select id="japanStaffFilter" class="filter-select">
            <option value="">NV Vận đơn</option>
          </select>
          <button id="japanClearFilters" class="clear-filter-btn">
            Xóa lọc
          </button>
        </div>
      </div>
      <div class="main-table-wrapper" id="japanTableContainer">
        <table>
          <thead id="japanTableHead"></thead>
          <tbody id="japanTableBody"></tbody>
        </table>
      </div>
    </div>

    <div
      class="pagination-container"
      style="display: none; text-align: center; margin-top: 20px"
    >
      <button id="prevPage" class="pagination-btn">Previous</button>
      <button id="firstPage" class="pagination-btn">1</button>
      <button id="currentPage" class="pagination-btn">1</button>
      <button id="lastPage" class="pagination-btn">1</button>
      <button id="nextPage" class="pagination-btn">Next</button>
    </div>
    <script src="datavandonnew.js"></script>
  </body>
</html>
